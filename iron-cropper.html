<script src="../cropperjs/dist/cropper.min.js"></script>

<link rel="import" href="../polymer/polymer.html">

<!--
`iron-cropper`
Polymer 1.0 element that wraps around Cropper.js

@demo demo/index.html
-->

<dom-module id="iron-cropper">
  <link rel="import" type="css" href="../cropperjs/dist/cropper.min.css">

  <template>
    <style>
      :host {
        display: block;
        max-height: 469px;
      }
      #image {
        max-width: 100%;
      }
    </style>
    <div>
      <img id="image" src="[[src]]">
    </div>
  </template>

  <script>
    Polymer({

      is: 'iron-cropper',

      properties: {
        /**
         * The URL of the image to be cropped
         */
        src: {
          type: String,
          reflectToAttribute: true,
          observer: 'render'
        },

        /**
         * The options object as specified in https://github.com/fengyuanchen/cropperjs#options
         */
        options: {
          type: Object,
          value: function () {
            return { aspectRatio: 1 }
          }
        }
      },

      render: function () {
        if (!window.Cropper) {
          return console.error('Cropper has not been initialized');
        }

        if (this._cropper) {
          this._cropper.destroy();
        }

        this._cropper = new window.Cropper(this.$.image, Object.assign({}, this.options));
      }
    });
  </script>
</dom-module>
